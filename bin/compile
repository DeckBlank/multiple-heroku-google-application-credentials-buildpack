#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir> <env-dir>

BUILD_DIR=${1:-}
CACHE_DIR=${2:-}
ENV_DIR=${3:-}

echo "------> Multiple Generating .profile.d file to generate google-credentials.json at startup "

mkdir -p $BUILD_DIR/.profile.d
CREDENTIALS=${$(cat ${ENV_DIR}/GOOGLE_CREDENTIALS_*)@Q}
PATH=""
echo $CREDENTIALS
if [ -f ${ENV_DIR}/GOOGLE_CREDENTIALS_PATH ]; then
    PATH=$(cat ${ENV_DIR}/GOOGLE_CREDENTIALS_PATH)
fi
echo $PATH
#FILES=($(cat ${ENV_DIR}/GOOGLE_CREDENTIALS_FILES_*))
#BUNDLE=""
#for ((i = 0; i < ${#CREDENTIALS[@]}; ++i)); do
#     BUNDLE+="echo ${CREDENTIALS[$i]@Q} > /app/${PATH}/${FILES[$i]};"
#done
#
#
#echo BUNDLE > $BUILD_DIR/.profile.d/google-credentials.sh
#chmod +x $BUILD_DIR/.profile.d/google-credentials.sh
